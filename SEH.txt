SEH
>sigly-linked list
>allcoated on the stack
>the head of the list is pointed to by a pointer located at TEB.

0:000> dt _EXCEPTION_REGISTRATION_RECORD
ntdll!_EXCEPTION_REGISTRATION_RECORD
+0x000 Next : Ptr32 _EXCEPTION_REGISTRATION_RECORD
+0x004 Handler : Ptr32 _EXCEPTION_DISPOSITION

x86 asm:
	mov eax, dword ptr fs:[00000000h] ; retrieve the head
	push eax ; save the old head
	lea eax, [ebp-10h]
	mov dword ptr fs:[00000000h], eax ; set the new head
	.
	.
	.
	mov ecx, dword ptr [ebp-10h] ; get the old head (NEXT field of the current head)
	mov dword ptr fs:[00000000h], ecx ; restore the old head

To get the address of the TEB,read fs:[18h]


!slist $teb _EXCEPTION_REGISTRATION_RECORD

!exchain

